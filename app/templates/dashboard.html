{% extends "base.html" %}
{% block content %}

<style>
    .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding: 0 20px;
    }
    
    .dashboard-nav {
        display: flex;
        gap: 10px;
    }
    
    .dashboard-nav a {
        padding: 10px 20px;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.2s;
    }
    
    .dashboard-nav a.active {
        background: #1f3c88;
        color: white;
    }
    
    .dashboard-nav a:not(.active) {
        background: #f0f0f0;
        color: #333;
    }
    
    .dashboard-nav a:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    /* Override section spacing for cleaner layout */
    section.cards {
        margin: 30px 0;
    }

    section.charts {
        margin: 40px 0;
    }

    section.insights {
        margin: 40px 0;
        padding: 20px;
    }

    .insight-box {
        margin-bottom: 0;
    }

    /* Chart and Alerts Section */
    .chart-alerts-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 35px;
        margin: 50px 20px;
        padding: 20px;
        align-items: start;
    }

    .chart-center-wrapper {
        background: white;
        border-radius: 8px;
        padding: 35px 30px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100%;
    }

    .chart-center-wrapper h3 {
        margin: 0 0 25px 0;
        color: #1f3c88;
        font-size: 18px;
        text-align: center;
        font-weight: 600;
    }

    .chart-center-wrapper canvas {
        max-height: 300px;
    }

    .alerts-section {
        background: white;
        border-left: 5px solid #f44336;
        border-radius: 8px;
        padding: 35px 30px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .alerts-section h3 {
        margin-top: 0;
        margin-bottom: 20px;
        color: #1f3c88;
        font-size: 18px;
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 600;
    }

    #criticalAlerts {
        list-style: none;
        padding: 0;
        margin: 0;
        flex-grow: 1;
        overflow-y: auto;
        max-height: 350px;
    }

    #criticalAlerts li {
        padding: 16px 18px;
        margin-bottom: 14px;
        background: #fff5f5;
        border-left: 4px solid #f44336;
        border-radius: 4px;
        font-size: 14px;
        color: #333;
        line-height: 1.7;
    }

    #criticalAlerts li:hover {
        background: #ffebee;
        transform: translateX(4px);
        transition: all 0.2s;
    }

    #criticalAlerts li strong {
        color: #1f3c88;
        font-weight: 600;
    }

    @media (max-width: 768px) {
        .chart-alerts-container {
            grid-template-columns: 1fr;
        }
    }
</style>

<!-- Dashboard Header with Navigation -->
<div class="dashboard-header">
    <h1>üìä Lab Reports Dashboard</h1>
    <div class="dashboard-nav">
        <a href="/dashboard" class="active">üìä Lab Dashboard</a>
        <a href="/ml-dashboard">ü§ñ ML Dashboard</a>
    </div>
</div>

<section class="cards">
    <div class="card"><h3>Total Labs</h3><p id="totalLabs">‚Äì</p></div>
    <div class="card normal"><h3>Normal</h3><p id="normalCount">‚Äì</p></div>
    <div class="card abnormal"><h3>Abnormal</h3><p id="abnormalCount">‚Äì</p></div>
    <div class="card critical"><h3>Critical</h3><p id="criticalCount">‚Äì</p></div>
    <div class="card unknown"><h3>Unknown</h3><p id="unknownCount">‚Äì</p></div>
</section>

<!-- OVERALL STATUS CHART + UNREVIEWED ALERTS (Side by Side) -->
<section class="chart-alerts-container">
    <div class="chart-center-wrapper">
        <h3>Overall Lab Status Distribution</h3>
        <canvas id="statusChart"></canvas>
    </div>
    
    <div class="alerts-section">
        <h3>‚ö†Ô∏è Unreviewed Critical Alerts</h3>
        <ul id="criticalAlerts"></ul>
    </div>
</section>

<!-- DETAILED CHARTS (Side by Side) -->
<section class="charts">
    <div class="chart-box">
        <h3>Abnormal & Critical Labs by Test</h3>
        <canvas id="labChart"></canvas>
    </div>
    <div class="chart-box">
        <h3>Abnormal & Critical Labs by Gender</h3>
        <canvas id="genderChart"></canvas>
    </div>
</section>

<section class="insights">
    <div class="insight-box">
        <h3>Top Affected Lab Tests</h3>
        <table id="topTestsTable">
            <thead>
                <tr><th>Test</th><th>Status</th><th>Patients</th></tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</section>

{% endblock %}
